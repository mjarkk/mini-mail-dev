import{s as $,t as a,d as T,a as b,i as o,c as r,M as p,S as w,l as B,_ as z,u as q,b as y,e as C,f as A,g as M,E as x,F as V,m as P,h as k,j as g,k as Z,n as E,o as S}from"./index-cddee69d.js";const I=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M5 21q-.825 0-1.413-.588T3 19V5q0-.825.588-1.413T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.588 1.413T19 21H5Zm0-2h14V5H5v14Zm1-2h12l-3.75-5l-3 4L9 13l-3 4Zm-1 2V5v14Z">'),R=(e={})=>(()=>{const l=I();return $(l,e,!0,!0),l})(),F=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M6 22q-.825 0-1.413-.588T4 20V4q0-.825.588-1.413T6 2h9l5 5v13q0 .825-.588 1.413T18 22H6Zm0-2h12V8h-4V4H6v16Zm6-1q1.675 0 2.838-1.175T16 15v-4h-2v4q0 .825-.575 1.413T12 17q-.825 0-1.413-.588T10 15V9.5q0-.225.15-.363T10.5 9q.225 0 .363.138T11 9.5V15h2V9.5q0-1.05-.725-1.775T10.5 7q-1.05 0-1.775.725T8 9.5V15q0 1.65 1.175 2.825T12 19ZM6 4v4v-4v16V4Z">'),L=(e={})=>(()=>{const l=F();return $(l,e,!0,!0),l})(),j=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.713T11 7.5H9v5Zm1-3v-1h1v1h-1Zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.713T15 7.5h-2v5Zm1-1v-3h1v3h-1Zm3 1h1v-2h1v-1h-1v-1h1v-1h-2v5ZM8 18q-.825 0-1.413-.588T6 16V4q0-.825.588-1.413T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.588 1.413T20 18H8Zm0-2h12V4H8v12Zm-4 6q-.825 0-1.413-.588T2 20V6h2v14h14v2H4ZM8 4v12V4Z">'),D=(e={})=>(()=>{const l=j();return $(l,e,!0,!0),l})(),O=a("<button p-4 border-0 w=180px><div truncate>"),U=e=>e==="application/pdf"||e==="application/x-pdf"||e==="application/x-bzpdf",W=e=>e.startsWith("image/");function G({contentType:e,filename:l,onclick:d}){const i={height:"30px",width:"30px"};return(()=>{const t=O(),n=t.firstChild;return b(t,"click",d,!0),o(t,r(w,{get fallback(){return r(L,{style:i})},get children(){return[r(p,{get when(){return W(e)},get children(){return r(R,{style:i})}}),r(p,{get when(){return U(e)},get children(){return r(D,{style:i})}})]}}),n),o(n,l),t})()}T(["click"]);const J=a("<div flex flex-col overflow-y-hidden h-screen>"),K=a("<div bg-zinc-900><div flex justify-between items-center p-4 border-0 border-b border-b-solid border-zinc-800><h2 font-bold m-0></h2><div><button border border-zinc-400>Delete</button></div></div><div border-0 border-b border-b-solid border-zinc-800 p-4 flex flex-wrap>"),N=a("<span mr-3>: "),Q=a("<div border-0 border-b border-b-solid border-zinc-800 p-4><p m-0 text-zinc-500>Attachments:</p><div flex flex-wrap gap-2 mt-1>"),X=a("<div p-4 flex-1 overflow-y-auto><pre>"),Y=a("<div flex-1>"),ee=a("<button border-0>"),te=a("<iframe flex-1 w-full bg-white h-100>"),ne=a("<pre p-4 overflow-y-auto>"),re=a("<div p-4 overflow-y-auto>"),le=a("<div flex flex-col h-full><div flex gap-1 p-4>"),ie=a("<p text-zinc-500>This email does not have a plain text fallback 😞"),oe=a("<p italic text-zinc-500>"),ce=B(()=>z(()=>import("./Code-525449a4.js"),["assets/Code-525449a4.js","assets/index-cddee69d.js","assets/index-70cbbf13.css","assets/Code-313b7763.css"]).then(e=>({default:e.Code})));function pe({}){const[e]=q(y),l=()=>e(),[d,i]=C(),t=async n=>{i(void 0);const c=await S(`/api/emails/${n}/remainder`),s=await c.json();if(c.status!==200)throw s.error;i(s)};return A(()=>{const n=e();n&&t(n.id)}),(()=>{const n=J();return o(n,r(se,{email:l,emailRemainder:d}),null),o(n,r(ae,{email:l,emailRemainder:d}),null),o(n,r(de,{email:l,emailRemainder:d}),null),n})()}function se({email:e,emailRemainder:l}){const[d,i]=q(y),t=M(()=>{const n=e(),c=[],s=(m,h)=>{h&&h.length>0&&c.push({name:m,value:h.map(v=>r(x,{address:()=>v}))})};n.sender&&c.push({name:"Sender",value:[r(x,{address:()=>n.sender})]}),s("From",n.from),s("To",n.to);const u=l();return u&&(s("ReplyTo",u.replyTo),s("CC",u.cc),s("BCC",u.bcc)),c});return(()=>{const n=K(),c=n.firstChild,s=c.firstChild,u=s.nextSibling,m=u.firstChild,h=c.nextSibling;return o(s,()=>e().subject),b(m,"click",i.delete,!0),o(h,r(V,{get each(){return t()},children:v=>(()=>{const f=N(),H=f.firstChild;return o(f,()=>v.name,H),o(f,()=>v.value,null),f})()})),n})()}function ae({emailRemainder:e,email:l}){const d=(t,n)=>{const c=document.createElement("a");c.download=t,c.href=E("/api/emails/"+l().id+"/attachments/"+n),c.click()},i=()=>{var t,n;return(((n=(t=e())==null?void 0:t.attachments)==null?void 0:n.length)??0)>0};return r(k,{get when(){return i()},get children(){const t=Q(),n=t.firstChild,c=n.nextSibling;return o(c,r(V,{get each(){return e().attachments},children:(s,u)=>r(G,P(s,{onclick:()=>d(s.filename,u())}))})),t}})}function de({email:e,emailRemainder:l}){const d=()=>{var t;return((t=l())==null?void 0:t.htmlBody)??""},i=()=>{var t;return((t=l())==null?void 0:t.textBody)??""};return r(w,{get children(){return[r(p,{get when(){return e().bodyType==="text"},get children(){const t=X(),n=t.firstChild;return o(t,r(ue,{kind:"text/plain"}),null),g(()=>n.innerText=i()),t}}),r(p,{get when(){return e().bodyType==="html"},get children(){const t=Y();return o(t,r(he,{email:e,html:d,plain:i})),t}})]}})}function _({onclick:e,selected:l,children:d}){return(()=>{const i=ee();return b(i,"click",e,!0),o(i,d),g(()=>Z(i,"text",l()?"indigo-400":"zinc-200")),i})()}function he({email:e,html:l,plain:d}){const[i,t]=C("preview"),n=()=>i()==="preview",c=()=>i()==="plain",s=()=>i()==="html";return(()=>{const u=le(),m=u.firstChild;return o(m,r(_,{onclick:()=>t("preview"),selected:n,children:"Preview"}),null),o(m,r(_,{onclick:()=>t("plain"),selected:c,children:"Plain text"}),null),o(m,r(_,{onclick:()=>t("html"),selected:s,children:"HTML"}),null),o(u,r(w,{get children(){return[r(p,{get when(){return n()},get children(){const h=te();return g(()=>Z(h,"src",E(`/api/emails/${e().id}/page`))),h}}),r(p,{get when(){return c()},get children(){return r(k,{get when(){return d()},get fallback(){return ie()},get children(){const h=ne();return g(()=>h.innerText=d()),h}})}}),r(p,{get when(){return s()},get children(){const h=re();return o(h,r(ce,{lang:"xml",code:l})),h}})]}}),null),u})()}function ue({kind:e}){return(()=>{const l=oe();return o(l,e),l})()}T(["click"]);export{pe as Email};
