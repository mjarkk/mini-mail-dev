import{d as y,u as V,S as A,c as P,a as n,E,b as v,i as d,I as H,F as M,t as u,s as k,M as g,e as C,o as j,f as F,P as U,g as T,h as z,j as b,k as q,l as w,m as D,n as B,p as O,_ as N,q as W,r as G,v as J}from"./index-brl1C-fK.js";const K=u("<div bg-zinc-900><div flex justify-between items-center p-4 border-0 border-b border-b-solid border-zinc-800><h2 font-bold m-0 flex items-center><button p-0 text-zinc-400 inline-flex mt-1 mr-2></button></h2><div><button bg-zinc-700 hover:bg-zinc-600>Delete</button></div></div><div border-0 border-b border-b-solid border-zinc-800 p-4 flex flex-wrap>"),Q=u("<span mr-3>: ");function X({email:t,emailRemainder:r}){const[l,i]=V(A),m=P(()=>{const c=t(),h=[],e=(p,f)=>{f&&f.length>0&&h.push({name:p,value:f.map(s=>n(E,{address:()=>s}))})};c.sender&&h.push({name:"Sender",value:[n(E,{address:()=>c.sender})]}),e("From",c.from),e("To",c.to);const o=r();return o&&(e("ReplyTo",o.replyTo),e("CC",o.cc),e("BCC",o.bcc)),h});return(()=>{const c=K(),h=c.firstChild,e=h.firstChild,o=e.firstChild,p=e.nextSibling,f=p.firstChild,s=h.nextSibling;return v(o,"click",i.deSelect,!0),d(o,n(H,{})),d(e,()=>t().subject,null),v(f,"click",i.delete,!0),d(s,n(M,{get each(){return m()},children:a=>(()=>{const $=Q(),_=$.firstChild;return d($,()=>a.name,_),d($,()=>a.value,null),$})()})),c})()}y(["click"]);const Y=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zm1-2h12l-3.75-5l-3 4L9 13zm-1 2V5z">'),Z=(t={})=>(()=>{const r=Y();return k(r,t,!0,!0),r})(),ee=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h9l5 5v13q0 .825-.587 1.413T18 22zm0-2h12V8h-4V4H6zm6-1q1.675 0 2.838-1.175T16 15v-4h-2v4q0 .825-.575 1.413T12 17q-.825 0-1.412-.587T10 15V9.5q0-.225.15-.363T10.5 9q.225 0 .363.138T11 9.5V15h2V9.5q0-1.05-.725-1.775T10.5 7q-1.05 0-1.775.725T8 9.5V15q0 1.65 1.175 2.825T12 19M6 4v4zv16z">'),te=(t={})=>(()=>{const r=ee();return k(r,t,!0,!0),r})(),ne=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V6h2v14h14v2zM8 4v12z">'),re=(t={})=>(()=>{const r=ne();return k(r,t,!0,!0),r})();function R({contentType:t}){const r={height:"30px",width:"30px"};return n(C,{get fallback(){return n(te,{style:r})},get children(){return[n(g,{get when(){return L(t())},get children(){return n(Z,{style:r})}}),n(g,{get when(){return I(t())},get children(){return n(re,{style:r})}})]}})}const le=u("<button p-4 border-0 w=180px><div truncate>"),I=t=>t==="application/pdf"||t==="application/x-pdf"||t==="application/x-bzpdf",L=t=>t.startsWith("image/");function ie({attachment:t,onclick:r}){return(()=>{const l=le(),i=l.firstChild;return v(l,"click",r,!0),d(l,n(R,{contentType:()=>t().contentType}),i),d(i,()=>t().filename),l})()}y(["click"]);const ce=u("<div fixed z-100 top-0 left-0 h-screen w-screen p-10 bg=black/40><div mx-auto bg-zinc-900 rounded max-w=800px h-full shadow-xl overflow-hidden flex flex-col><div p-6 border-0 border-zinc-800 border-b border-b-solid><p m-0></p></div><div py-4 px-6 flex justify-end gap-2 items-center border-0 border-zinc-800 border-t border-t-solid><button bg-zinc-700 hover:bg-zinc-600>Close</button><button bg-zinc-700 hover:bg-zinc-600>Download"),oe=u("<div h-full w-full bg-center bg-contain bg-no-repeat>"),se=u("<iframe h-full>"),ae=u("<p flex flex-col justify-center items-center h-full text-zinc-400><span mt-3>Content not displayable");function de({onClose:t,attachmentUrl:r,attachment:l}){let i;const m=e=>{var o;(!i||i===e.target||i===((o=e.target.children)==null?void 0:o[0]))&&t()},c=()=>{const e=document.createElement("a");e.download=l().filename,e.href=r(),e.click()},h=e=>{e.key==="Escape"&&t()};return j(()=>{document.addEventListener("keydown",h)}),F(()=>{document.removeEventListener("keydown",h)}),n(U,{get mount(){return document.body},get children(){const e=ce(),o=e.firstChild,p=o.firstChild,f=p.firstChild,s=p.nextSibling,a=s.firstChild,$=a.nextSibling;e.$$click=m;const _=i;return typeof _=="function"?D(_,e):i=e,d(f,()=>l().filename),d(o,n(ue,{attachment:l,attachmentUrl:r}),s),v(a,"click",t,!0),$.$$click=c,e}})}function ue({attachment:t,attachmentUrl:r}){const[l,i]=T(void 0),m=async()=>{const h=await(await fetch(r())).blob(),e=URL.createObjectURL(h);i(e)};return z(()=>{m()}),n(w,{get when(){return l()},get children(){return n(C,{get fallback(){return n(he,{contentType:()=>t().contentType})},get children(){return[n(g,{get when(){return L(t().contentType)},get children(){const c=oe();return b(()=>`url(${l()})`!=null?c.style.setProperty("background-image",`url(${l()})`):c.style.removeProperty("background-image")),c}}),n(g,{get when(){return I(t().contentType)},get children(){const c=se();return b(()=>q(c,"src",l())),c}})]}})}})}function he({contentType:t}){return(()=>{const r=ae(),l=r.firstChild;return d(r,n(R,{contentType:t}),l),r})()}y(["click"]);const me=u("<div border-0 border-b border-b-solid border-zinc-800 p-4><p m-0 text-zinc-500>Attachments:</p><div flex flex-wrap gap-2 mt-1>");function pe({emailRemainder:t,email:r,hasAttachments:l}){const[i,m]=T();return z(()=>{r(),m(void 0)}),[n(w,{get when(){return l()},get children(){const c=me(),h=c.firstChild,e=h.nextSibling;return d(e,n(M,{get each(){return t().attachments},children:(o,p)=>n(ie,{attachment:()=>o,onclick:()=>m(p)})})),c}}),n(w,{get when(){return P(()=>i()!==void 0)()&&l()},get children(){return n(de,{onClose:()=>m(void 0),attachmentUrl:()=>B("/api/emails/"+r().id+"/attachments/"+i()),attachment:()=>t().attachments[i()]})}})]}const fe=u("<div flex gap-1 p-4>"),ge=u("<iframe flex-1 w-full h-full bg-white>"),be=u("<div p-4 pt-0>"),S=u("<pre p-4 pt-0>"),$e=u("<div self-stretch overflow-y-auto>"),ve=u("<p p-4 pt-0 text-zinc-500>This email does not have a plain text fallback ðŸ˜ž"),we=u("<button border-0>"),_e=O(()=>N(()=>import("./Code-1S_lVFgV.js"),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.Code})));function xe({email:t,emailRemainder:r}){const[l,i]=T("plain"),m=()=>l()==="preview",c=()=>l()==="plain",h=()=>l()==="html",e=()=>l()==="raw",o=()=>{var s;return((s=r())==null?void 0:s.textBody)??""},p=()=>{var s;return((s=r())==null?void 0:s.htmlBody)??""},f=()=>{var s;return((s=r())==null?void 0:s.raw)??""};return z(W(t,s=>{const a=l();s.bodyType==="html"?a==="plain"&&i("preview"):(a==="preview"||a==="html")&&i("plain")})),[(()=>{const s=fe();return d(s,n(w,{get when(){return t().bodyType==="html"},get children(){return[n(x,{onclick:()=>i("preview"),selected:m,children:"Preview"}),n(x,{onclick:()=>i("html"),selected:h,children:"HTML"})]}}),null),d(s,n(x,{onclick:()=>i("plain"),selected:c,children:"Plain text"}),null),d(s,n(x,{onclick:()=>i("raw"),selected:e,children:"Raw"}),null),s})(),(()=>{const s=$e();return d(s,n(C,{get children(){return[n(g,{get when(){return m()},get children(){const a=ge();return b(()=>q(a,"src",B(`/api/emails/${t().id}/page`))),a}}),n(g,{get when(){return h()},get children(){const a=be();return d(a,n(_e,{lang:"xml",code:p})),a}}),n(g,{get when(){return c()},get children(){return n(w,{get when(){return o()},get fallback(){return ve()},get children(){const a=S();return b(()=>a.innerText=o()),a}})}}),n(g,{get when(){return e()},get children(){const a=S();return b(()=>a.innerText=f()),a}})]}})),s})()]}function x({onclick:t,selected:r,children:l}){return(()=>{const i=we();return v(i,"click",t,!0),d(i,l),b(()=>q(i,"text",r()?"indigo-400":"zinc-200")),i})()}y(["click"]);const ye=u("<div flex-1 self-stretch overflow-y-hidden h-screen max-h-screen grid>");function ze(){const[t]=V(A),r=()=>t(),[l,i]=T(),m=async e=>{i(void 0);const o=await J(`/api/emails/${e}/remainder`),p=await o.json();if(o.status!==200)throw p.error;i(p)};z(()=>{const e=t();e&&m(e.id)});const c=()=>{var e,o;return(((o=(e=l())==null?void 0:e.attachments)==null?void 0:o.length)??0)>0},h=()=>({"grid-template-columns":"1fr","grid-template-rows":c()?"auto auto 60px 1fr":"auto 60px 1fr"});return(()=>{const e=ye();return d(e,n(X,{email:r,emailRemainder:l}),null),d(e,n(pe,{email:r,emailRemainder:l,hasAttachments:c}),null),d(e,n(xe,{email:r,emailRemainder:l}),null),b(o=>G(e,h(),o)),e})()}export{ze as ShowEmail};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Code-1S_lVFgV.js","assets/index-brl1C-fK.js","assets/index-WeMh_2BT.css","assets/Code-1ehz9Hc3.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}