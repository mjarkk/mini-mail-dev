import{s as T,t as a,c as n,M as p,S as v,d as z,a as _,i as d,o as L,b as R,P as j,e as w,f as E,g as b,h as k,j as $,u as I,l as F,_ as U,k as A,m as V,n as D,E as q,F as P,p as S,q as O}from"./index-iZxhnyrw.js";const N=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zm1-2h12l-3.75-5l-3 4L9 13zm-1 2V5z">'),W=(e={})=>(()=>{const t=N();return T(t,e,!0,!0),t})(),G=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h9l5 5v13q0 .825-.587 1.413T18 22zm0-2h12V8h-4V4H6zm6-1q1.675 0 2.838-1.175T16 15v-4h-2v4q0 .825-.575 1.413T12 17q-.825 0-1.412-.587T10 15V9.5q0-.225.15-.363T10.5 9q.225 0 .363.138T11 9.5V15h2V9.5q0-1.05-.725-1.775T10.5 7q-1.05 0-1.775.725T8 9.5V15q0 1.65 1.175 2.825T12 19M6 4v4zv16z">'),J=(e={})=>(()=>{const t=G();return T(t,e,!0,!0),t})(),K=a('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V6h2v14h14v2zM8 4v12z">'),Q=(e={})=>(()=>{const t=K();return T(t,e,!0,!0),t})();function B({contentType:e}){const t={height:"30px",width:"30px"};return n(v,{get fallback(){return n(J,{style:t})},get children(){return[n(p,{get when(){return H(e())},get children(){return n(W,{style:t})}}),n(p,{get when(){return M(e())},get children(){return n(Q,{style:t})}})]}})}const X=a("<button p-4 border-0 w=180px><div truncate>"),M=e=>e==="application/pdf"||e==="application/x-pdf"||e==="application/x-bzpdf",H=e=>e.startsWith("image/");function Y({attachment:e,onclick:t}){return(()=>{const i=X(),o=i.firstChild;return _(i,"click",t,!0),d(i,n(B,{contentType:()=>e().contentType}),o),d(o,()=>e().filename),i})()}z(["click"]);const Z=a("<div fixed z-100 top-0 left-0 h-screen w-screen p-10 bg=black/40><div mx-auto bg-zinc-900 rounded max-w=800px h-full shadow-xl overflow-hidden flex flex-col><div p-6 border-0 border-zinc-800 border-b border-b-solid><p m-0></p></div><div py-4 px-6 flex justify-end gap-2 items-center border-0 border-zinc-800 border-t border-t-solid><button border-zinc-500>Close</button><button border-zinc-500>Download"),ee=a("<div h-full w-full bg-center bg-contain bg-no-repeat>"),te=a("<iframe>"),ne=a("<p flex flex-col justify-center items-center h-full text-zinc-400><span mt-3>Content not displayable");function re({onClose:e,attachmentUrl:t,attachment:i}){let o;const c=l=>{var u;(!o||o===l.target||o===((u=l.target.children)==null?void 0:u[0]))&&e()},r=()=>{const l=document.createElement("a");l.download=i().filename,l.href=t(),l.click()},s=l=>{l.key==="Escape"&&e()};return L(()=>{document.addEventListener("keydown",s)}),R(()=>{document.removeEventListener("keydown",s)}),n(j,{get mount(){return document.body},get children(){const l=Z(),u=l.firstChild,m=u.firstChild,h=m.firstChild,f=m.nextSibling,g=f.firstChild,x=g.nextSibling;l.$$click=c;const C=o;return typeof C=="function"?I(C,l):o=l,d(h,()=>i().filename),d(u,n(le,{attachment:i,attachmentUrl:t}),f),_(g,"click",e,!0),x.$$click=r,l}})}function le({attachment:e,attachmentUrl:t}){const[i,o]=w(void 0),c=async()=>{const s=await(await fetch(t())).blob(),l=URL.createObjectURL(s);o(l)};return E(()=>{c()}),n($,{get when(){return i()},get children(){return n(v,{get fallback(){return n(ie,{contentType:()=>e().contentType})},get children(){return[n(p,{get when(){return H(e().contentType)},get children(){const r=ee();return b(()=>`url(${i()})`!=null?r.style.setProperty("background-image",`url(${i()})`):r.style.removeProperty("background-image")),r}}),n(p,{get when(){return M(e().contentType)},get children(){const r=te();return b(()=>k(r,"src",i())),r}})]}})}})}function ie({contentType:e}){return(()=>{const t=ne(),i=t.firstChild;return d(t,n(B,{contentType:e}),i),t})()}z(["click"]);const oe=a("<div flex flex-col overflow-y-hidden h-screen>"),ce=a("<div bg-zinc-900><div flex justify-between items-center p-4 border-0 border-b border-b-solid border-zinc-800><h2 font-bold m-0></h2><div><button border border-zinc-400>Delete</button></div></div><div border-0 border-b border-b-solid border-zinc-800 p-4 flex flex-wrap>"),se=a("<span mr-3>: "),de=a("<div border-0 border-b border-b-solid border-zinc-800 p-4><p m-0 text-zinc-500>Attachments:</p><div flex flex-wrap gap-2 mt-1>"),ae=a("<div p-4 flex-1 overflow-y-auto><pre>"),ue=a("<div flex-1>"),he=a("<button border-0>"),me=a("<iframe flex-1 w-full bg-white h-100>"),pe=a("<pre p-4 pt-0 overflow-y-auto>"),fe=a("<div p-4 pt-0 overflow-y-auto>"),ge=a("<div flex flex-col h-full><div flex gap-1 p-4>"),be=a("<p p-4 pt-0 text-zinc-500>This email does not have a plain text fallback ðŸ˜ž"),$e=a("<p italic text-zinc-500>"),ve=F(()=>U(()=>import("./Code-If-3YuaA.js"),__vite__mapDeps([0,1,2,3])).then(e=>({default:e.Code})));function ke({}){const[e]=A(V),t=()=>e(),[i,o]=w(),c=async r=>{o(void 0);const s=await O(`/api/emails/${r}/remainder`),l=await s.json();if(s.status!==200)throw l.error;o(l)};return E(()=>{const r=e();r&&c(r.id)}),(()=>{const r=oe();return d(r,n(_e,{email:t,emailRemainder:i}),null),d(r,n(we,{email:t,emailRemainder:i}),null),d(r,n(xe,{email:t,emailRemainder:i}),null),r})()}function _e({email:e,emailRemainder:t}){const[i,o]=A(V),c=D(()=>{const r=e(),s=[],l=(m,h)=>{h&&h.length>0&&s.push({name:m,value:h.map(f=>n(q,{address:()=>f}))})};r.sender&&s.push({name:"Sender",value:[n(q,{address:()=>r.sender})]}),l("From",r.from),l("To",r.to);const u=t();return u&&(l("ReplyTo",u.replyTo),l("CC",u.cc),l("BCC",u.bcc)),s});return(()=>{const r=ce(),s=r.firstChild,l=s.firstChild,u=l.nextSibling,m=u.firstChild,h=s.nextSibling;return d(l,()=>e().subject),_(m,"click",o.delete,!0),d(h,n(P,{get each(){return c()},children:f=>(()=>{const g=se(),x=g.firstChild;return d(g,()=>f.name,x),d(g,()=>f.value,null),g})()})),r})()}function we({emailRemainder:e,email:t}){const[i,o]=w(),c=()=>{var r,s;return(((s=(r=e())==null?void 0:r.attachments)==null?void 0:s.length)??0)>0};return[n($,{get when(){return c()},get children(){const r=de(),s=r.firstChild,l=s.nextSibling;return d(l,n(P,{get each(){return e().attachments},children:(u,m)=>n(Y,{attachment:()=>u,onclick:()=>o(m)})})),r}}),n($,{get when(){return i()!==void 0},get children(){return n(re,{onClose:()=>o(void 0),attachmentUrl:()=>S("/api/emails/"+t().id+"/attachments/"+i()),attachment:()=>e().attachments[i()]})}})]}function xe({email:e,emailRemainder:t}){const i=()=>{var c;return((c=t())==null?void 0:c.htmlBody)??""},o=()=>{var c;return((c=t())==null?void 0:c.textBody)??""};return n(v,{get children(){return[n(p,{get when(){return e().bodyType==="text"},get children(){const c=ae(),r=c.firstChild;return d(c,n(Te,{kind:"text/plain"}),null),b(()=>r.innerText=o()),c}}),n(p,{get when(){return e().bodyType==="html"},get children(){const c=ue();return d(c,n(ye,{email:e,html:i,plain:o})),c}})]}})}function y({onclick:e,selected:t,children:i}){return(()=>{const o=he();return _(o,"click",e,!0),d(o,i),b(()=>k(o,"text",t()?"indigo-400":"zinc-200")),o})()}function ye({email:e,html:t,plain:i}){const[o,c]=w("preview"),r=()=>o()==="preview",s=()=>o()==="plain",l=()=>o()==="html";return(()=>{const u=ge(),m=u.firstChild;return d(m,n(y,{onclick:()=>c("preview"),selected:r,children:"Preview"}),null),d(m,n(y,{onclick:()=>c("plain"),selected:s,children:"Plain text"}),null),d(m,n(y,{onclick:()=>c("html"),selected:l,children:"HTML"}),null),d(u,n(v,{get children(){return[n(p,{get when(){return r()},get children(){const h=me();return b(()=>k(h,"src",S(`/api/emails/${e().id}/page`))),h}}),n(p,{get when(){return s()},get children(){return n($,{get when(){return i()},get fallback(){return be()},get children(){const h=pe();return b(()=>h.innerText=i()),h}})}}),n(p,{get when(){return l()},get children(){const h=fe();return d(h,n(ve,{lang:"xml",code:t})),h}})]}}),null),u})()}function Te({kind:e}){return(()=>{const t=$e();return d(t,e),t})()}z(["click"]);export{ke as Email};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Code-If-3YuaA.js","assets/index-iZxhnyrw.js","assets/index-LaGMYNzb.css","assets/Code-1ehz9Hc3.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}