const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Code-D7xWD-0y.js","assets/index-Cr7WSgpa.js","assets/index-CygxqtQR.css","assets/Code-DV6HP0dz.css"])))=>i.map(i=>d[i]);
import{d as y,u as V,S as A,c as P,a as r,E,b as $,i as h,I as j,F as M,t as u,s as k,M as f,e as C,o as R,f as F,P as D,g as T,h as z,j as g,k as q,l as w,m as U,n as B,p as O,_ as N,q as W,r as G,v as J}from"./index-Cr7WSgpa.js";var K=u("<div bg-zinc-900><div flex justify-between items-center p-4 border-0 border-b border-b-solid border-zinc-800><h2 font-bold m-0 flex items-center><button p-0 text-zinc-400 inline-flex mt-1 mr-2></button></h2><div><button bg-zinc-700 hover:bg-zinc-600>Delete</button></div></div><div border-0 border-b border-b-solid border-zinc-800 p-4 flex flex-wrap>"),Q=u("<span mr-3>: ");function X({email:t,emailRemainder:n}){const[i,l]=V(A),m=P(()=>{const o=t(),s=[],e=(p,v)=>{v&&v.length>0&&s.push({name:p,value:v.map(a=>r(E,{address:()=>a}))})};o.sender&&s.push({name:"Sender",value:[r(E,{address:()=>o.sender})]}),e("From",o.from),e("To",o.to);const c=n();return c&&(e("ReplyTo",c.replyTo),e("CC",c.cc),e("BCC",c.bcc)),s});return(()=>{var o=K(),s=o.firstChild,e=s.firstChild,c=e.firstChild,p=e.nextSibling,v=p.firstChild,a=s.nextSibling;return $(c,"click",l.deSelect,!0),h(c,r(j,{})),h(e,()=>t().subject,null),$(v,"click",l.delete,!0),h(a,r(M,{get each(){return m()},children:d=>(()=>{var b=Q(),_=b.firstChild;return h(b,()=>d.name,_),h(b,()=>d.value,null),b})()})),o})()}y(["click"]);var Y=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zm1-2h12l-3.75-5l-3 4L9 13zm-1 2V5z">');const Z=(t={})=>(()=>{var n=Y();return k(n,t,!0),n})();var ee=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h9l5 5v13q0 .825-.587 1.413T18 22zm0-2h12V8h-4V4H6zm6-1q1.675 0 2.838-1.175T16 15v-4h-2v4q0 .825-.575 1.413T12 17q-.825 0-1.412-.587T10 15V9.5q0-.225.15-.363T10.5 9q.225 0 .363.138T11 9.5V15h2V9.5q0-1.05-.725-1.775T10.5 7t-1.775.725T8 9.5V15q0 1.65 1.175 2.825T12 19M6 4v4zv16z">');const te=(t={})=>(()=>{var n=ee();return k(n,t,!0),n})();var re=u('<svg viewBox="0 0 24 24"width=1.2em height=1.2em><path fill=currentColor d="M9 12.5h1v-2h1q.425 0 .713-.288T12 9.5v-1q0-.425-.288-.712T11 7.5H9zm1-3v-1h1v1zm3 3h2q.425 0 .713-.288T16 11.5v-3q0-.425-.288-.712T15 7.5h-2zm1-1v-3h1v3zm3 1h1v-2h1v-1h-1v-1h1v-1h-2zM8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V6h2v14h14v2zM8 4v12z">');const ne=(t={})=>(()=>{var n=re();return k(n,t,!0),n})();function I({contentType:t}){const n={height:"30px",width:"30px"};return r(C,{get fallback(){return r(te,{style:n})},get children(){return[r(f,{get when(){return H(t())},get children(){return r(Z,{style:n})}}),r(f,{get when(){return L(t())},get children(){return r(ne,{style:n})}})]}})}var le=u("<button p-4 border-0 w=180px><div truncate>");const L=t=>t==="application/pdf"||t==="application/x-pdf"||t==="application/x-bzpdf",H=t=>t.startsWith("image/");function ie({attachment:t,onclick:n}){return(()=>{var i=le(),l=i.firstChild;return $(i,"click",n,!0),h(i,r(I,{contentType:()=>t().contentType}),l),h(l,()=>t().filename),i})()}y(["click"]);var oe=u("<div fixed z-100 top-0 left-0 h-screen w-screen p-10 bg=black/40><div mx-auto bg-zinc-900 rounded max-w=800px h-full shadow-xl overflow-hidden flex flex-col><div p-6 border-0 border-zinc-800 border-b border-b-solid><p m-0></p></div><div py-4 px-6 flex justify-end gap-2 items-center border-0 border-zinc-800 border-t border-t-solid><button bg-zinc-700 hover:bg-zinc-600>Close</button><button bg-zinc-700 hover:bg-zinc-600>Download"),ce=u("<div h-full w-full bg-center bg-contain bg-no-repeat>"),ae=u("<iframe h-full>"),se=u("<p flex flex-col justify-center items-center h-full text-zinc-400><span mt-3>Content not displayable");function de({onClose:t,attachmentUrl:n,attachment:i}){let l;const m=e=>{var c;(!l||l===e.target||l===((c=e.target.children)==null?void 0:c[0]))&&t()},o=()=>{const e=document.createElement("a");e.download=i().filename,e.href=n(),e.click()},s=e=>{e.key==="Escape"&&t()};return R(()=>{document.addEventListener("keydown",s)}),F(()=>{document.removeEventListener("keydown",s)}),r(D,{get mount(){return document.body},get children(){var e=oe(),c=e.firstChild,p=c.firstChild,v=p.firstChild,a=p.nextSibling,d=a.firstChild,b=d.nextSibling;e.$$click=m;var _=l;return typeof _=="function"?U(_,e):l=e,h(v,()=>i().filename),h(c,r(he,{attachment:i,attachmentUrl:n}),a),$(d,"click",t,!0),b.$$click=o,e}})}function he({attachment:t,attachmentUrl:n}){const[i,l]=T(void 0),m=async()=>{const s=await(await fetch(n())).blob(),e=URL.createObjectURL(s);l(e)};return z(()=>{m()}),r(w,{get when(){return i()},get children(){return r(C,{get fallback(){return r(ue,{contentType:()=>t().contentType})},get children(){return[r(f,{get when(){return H(t().contentType)},get children(){var o=ce();return g(s=>(s=`url(${i()})`)!=null?o.style.setProperty("background-image",s):o.style.removeProperty("background-image")),o}}),r(f,{get when(){return L(t().contentType)},get children(){var o=ae();return g(()=>q(o,"src",i())),o}})]}})}})}function ue({contentType:t}){return(()=>{var n=se(),i=n.firstChild;return h(n,r(I,{contentType:t}),i),n})()}y(["click"]);var me=u("<div border-0 border-b border-b-solid border-zinc-800 p-4><p m-0 text-zinc-500>Attachments:</p><div flex flex-wrap gap-2 mt-1>");function pe({emailRemainder:t,email:n,hasAttachments:i}){const[l,m]=T();return z(()=>{n(),m(void 0)}),[r(w,{get when(){return i()},get children(){var o=me(),s=o.firstChild,e=s.nextSibling;return h(e,r(M,{get each(){return t().attachments},children:(c,p)=>r(ie,{attachment:()=>c,onclick:()=>m(p)})})),o}}),r(w,{get when(){return P(()=>l()!==void 0)()&&i()},get children(){return r(de,{onClose:()=>m(void 0),attachmentUrl:()=>B("/api/emails/"+n().id+"/attachments/"+l()),attachment:()=>t().attachments[l()]})}})]}var ve=u("<div flex gap-1 p-4>"),fe=u("<iframe flex-1 w-full h-full bg-white>"),ge=u("<div p-4 pt-0>"),S=u("<pre p-4 pt-0>"),be=u("<div self-stretch overflow-y-auto>"),$e=u("<p p-4 pt-0 text-zinc-500>This email does not have a plain text fallback ðŸ˜ž"),we=u("<button border-0>");const _e=O(()=>N(()=>import("./Code-D7xWD-0y.js"),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.Code})));function xe({email:t,emailRemainder:n}){const[i,l]=T("plain"),m=()=>i()==="preview",o=()=>i()==="plain",s=()=>i()==="html",e=()=>i()==="raw",c=()=>{var a;return((a=n())==null?void 0:a.textBody)??""},p=()=>{var a;return((a=n())==null?void 0:a.htmlBody)??""},v=()=>{var a;return((a=n())==null?void 0:a.raw)??""};return z(W(t,a=>{const d=i();a.bodyType==="html"?d==="plain"&&l("preview"):(d==="preview"||d==="html")&&l("plain")})),[(()=>{var a=ve();return h(a,r(w,{get when(){return t().bodyType==="html"},get children(){return[r(x,{onclick:()=>l("preview"),selected:m,children:"Preview"}),r(x,{onclick:()=>l("html"),selected:s,children:"HTML"})]}}),null),h(a,r(x,{onclick:()=>l("plain"),selected:o,children:"Plain text"}),null),h(a,r(x,{onclick:()=>l("raw"),selected:e,children:"Raw"}),null),a})(),(()=>{var a=be();return h(a,r(C,{get children(){return[r(f,{get when(){return m()},get children(){var d=fe();return g(()=>q(d,"src",B(`/api/emails/${t().id}/page`))),d}}),r(f,{get when(){return s()},get children(){var d=ge();return h(d,r(_e,{lang:"xml",code:p})),d}}),r(f,{get when(){return o()},get children(){return r(w,{get when(){return c()},get fallback(){return $e()},get children(){var d=S();return g(()=>d.innerText=c()),d}})}}),r(f,{get when(){return e()},get children(){var d=S();return g(()=>d.innerText=v()),d}})]}})),a})()]}function x({onclick:t,selected:n,children:i}){return(()=>{var l=we();return $(l,"click",t,!0),h(l,i),g(()=>q(l,"text",n()?"indigo-400":"zinc-200")),l})()}y(["click"]);var ye=u("<div flex-1 self-stretch overflow-y-hidden h-screen max-h-screen grid>");function ze({}){const[t]=V(A),n=()=>t(),[i,l]=T(),m=async e=>{l(void 0);const c=await J(`/api/emails/${e}/remainder`),p=await c.json();if(c.status!==200)throw p.error;l(p)};z(()=>{const e=t();e&&m(e.id)});const o=()=>{var e,c;return(((c=(e=i())==null?void 0:e.attachments)==null?void 0:c.length)??0)>0},s=()=>({"grid-template-columns":"1fr","grid-template-rows":o()?"auto auto 60px 1fr":"auto 60px 1fr"});return(()=>{var e=ye();return h(e,r(X,{email:n,emailRemainder:i}),null),h(e,r(pe,{email:n,emailRemainder:i,hasAttachments:o}),null),h(e,r(xe,{email:n,emailRemainder:i}),null),g(c=>G(e,s(),c)),e})()}export{ze as Show};
